<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Number Puzzle</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f0f4f8;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #container {
            width: 100%;
            max-width: 500px;
            margin: 20px;
            border-radius: 10px;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
        }

        #game {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        #game div {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            padding-bottom: 100%;
            background-color: #7BBECD;
            color: #fff;
            font-size: 2em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
        }

        #game div span {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #game div:hover {
            background-color: #4A9DAE;
        }

        #timeText {
            margin: 10px 0;
            font-size: 1.2em;
            color: #333;
        }

        #start, #reset {
            width: 100%;
            height: 55px;
            background-color: #7BBECD;
            border: none;
            border-radius: 10px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            color: #fff;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            transition: background-color 0.3s ease;
        }

        #start:hover, #reset:hover {
            background-color: #4A9DAE;
        }

        a {
            text-decoration: none;
            margin: 0 10px;
            padding: 5px;
            font-weight: bold;
            color: #4A9DAE;
            font-size: 1em;
        }

        a:hover {
            color: #333;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="a">
            | <a href="puzzle.html">Puzzle 1</a> ||
            <a href="trypuzzle.html">Puzzle 2</a> ||
            <a href="index.html">Menu</a> |
        </div>
        <div id="game">
            <div id="block1" onclick="move(1)"><span>1</span></div>
            <div id="block2" onclick="move(2)"><span>2</span></div>
            <div id="block3" onclick="move(3)"><span>3</span></div>
            <div id="block4" onclick="move(4)"><span>4</span></div>
            <div id="block5" onclick="move(5)"><span>5</span></div>
            <div id="block6" onclick="move(6)"><span>6</span></div>
            <div id="block7" onclick="move(7)"><span>7</span></div>
            <div id="block8" onclick="move(8)"><span>8</span></div>
        </div>
        <h3 id="timeText">Total Time ⏲️ <span id="timer"></span></h3>
        <button id="start" onclick="start()">START</button>
        <button id="reset" onclick="reset()">RESET</button>
    </div>
    <script>
        var time = 0;
        var set_timer;
        var pause = true;
        var block = [0, 1, 2, 3, 4, 5, 6, 7, 8, 0];
        var block_direction = [
            [0],
            [2, 4],
            [1, 3, 5],
            [2, 6],
            [1, 5, 7],
            [2, 4, 6, 8],
            [3, 5, 9],
            [4, 8],
            [5, 7, 9],
            [6, 8]
        ];
        var block_position = [
            [0],
            [0, 0],
            [150, 0],
            [300, 0],
            [0, 150],
            [150, 150],
            [300, 150],
            [0, 300],
            [150, 300],
            [300, 300]
        ];

        function move(id) {
            if (!pause) {
                var i = 1;
                for (i = 1; i < 10; ++i) {
                    if (block[i] == id) break;
                }
                var target_dir = move_dir(i);
                if (target_dir != 0) {
                    block[i] = 0;
                    block[target_dir] = id;
                    document.getElementById("block" + id).style.left = block_position[target_dir][0] + "px";
                    document.getElementById("block" + id).style.top = block_position[target_dir][1] + "px";
                }
            }
            var finish_flag = true;
            for (var k = 1; k < 9; ++k) {
                if (block[k] != k) {
                    finish_flag = false;
                    break;
                }
            }
            if (finish_flag) {
                if (!pause) start();
                alert("Congratulations!!");
            }
        }

        function move_dir(curr_loc) {
            var j = 0;
            var canMove = false;
            for (j = 0; j < block_direction[curr_loc].length; ++j) {
                if (block[block_direction[curr_loc][j]] == 0) {
                    canMove = true;
                    break;
                }
            }
            if (canMove) return block_direction[curr_loc][j];
            else return 0;
        }

        function timer() {
            time += 1;
            var min = parseInt(time / 60);
            var sec = time % 60;
            document.getElementById("timer").innerHTML = min + " min " + sec + " sec";
        }

        function start() {
            if (pause) {
                document.getElementById("start").innerText = "Pause";
                pause = false;
                set_timer = setInterval(timer, 1000);
            } else {
                document.getElementById("start").innerText = "Start";
                pause = true;
                clearInterval(set_timer);
            }
        }

        function reset() {
            time = 0;
            random_block();
            if (pause) start();
        }

        function shuffle(array) {
            for (var i = 9; i > 0; i--) {
                var j = Math.floor(Math.random() * (i - 1) + 1);
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
            return array;
        }

        function random_block() {
            var shuffle_array = [];
            var solvable = false;
            var inversion = 0;
            while (!solvable) {
                shuffle_array = shuffle(block.slice());
                inversion = 0;
                for (var i = 1; i < shuffle_array.length; i++) {
                    for (var j = i + 1; j < shuffle_array.length; j++) {
                        if (shuffle_array[i] && shuffle_array[j] && shuffle_array[i] > shuffle_array[j]) {
                            inversion++;
                        }
                    }
                }
                if (inversion % 2 === 0) solvable = true;
            }
            for (var i = 1; i < shuffle_array.length; i++) {
                if (shuffle_array[i] !== 0) {
                    document.getElementById("block" + shuffle_array[i]).style.left = block_position[i][0] + "px";
                    document.getElementById("block" + shuffle_array[i]).style.top = block_position[i][1] + "px";
                }
            }
        }

        window.onload = function() {
            reset();
        };
    </script>
</body>
</html>
